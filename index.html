<!DOCTYPE html>
<html lang="en">
  <head>
    <title>  Reference</title>
    <link rel="stylesheet" type="text/css" href="css/jazzy.css" />
    <link rel="stylesheet" type="text/css" href="css/highlight.css" />
    <meta charset='utf-8'>
    <script src="js/jquery.min.js" defer></script>
    <script src="js/jazzy.js" defer></script>
    
  </head>
  <body>
    <a title="  Reference"></a>
    <header>
      <div class="content-wrapper">
        <p><a href="index.html"> Docs</a> (86% documented)</p>
        <p class="header-right"><a href="https://github.com/StevenLambion/SwiftDux"><img src="img/gh.png"/>View on GitHub</a></p>
      </div>
    </header>
    <div class="content-wrapper">
      <p id="breadcrumbs">
        <a href="index.html"> Reference</a>
        <img id="carat" src="img/carat.png" />
          Reference
      </p>
    </div>
    <div class="content-wrapper">
      <nav class="sidebar">
        <ul class="nav-groups">
          <li class="nav-group-name">
            <a href="Documentation.html">Documentation</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a href="installation.html">Installation</a>
              </li>
              <li class="nav-group-task">
                <a href="getting-started.html">Getting Started</a>
              </li>
              <li class="nav-group-task">
                <a href="composing-reducers.html">Composing Reducers</a>
              </li>
              <li class="nav-group-task">
                <a href="persisting-state.html">Persisting State</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a href="State.html">State</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a href="State.html#/s:8SwiftDux9StateTypea">StateType</a>
              </li>
              <li class="nav-group-task">
                <a href="Protocols/IdentifiableState.html">IdentifiableState</a>
              </li>
              <li class="nav-group-task">
                <a href="Structs/OrderedState.html">OrderedState</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a href="Actions.html">Actions</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a href="Actions.html#/s:8SwiftDux6ActionP">Action</a>
              </li>
              <li class="nav-group-task">
                <a href="Structs/ActionPlan.html">ActionPlan</a>
              </li>
              <li class="nav-group-task">
                <a href="Protocols/ActionDispatcher.html">ActionDispatcher</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/ActionSubscriber.html">ActionSubscriber</a>
              </li>
              <li class="nav-group-task">
                <a href="Protocols/RunnableAction.html">RunnableAction</a>
              </li>
              <li class="nav-group-task">
                <a href="Structs/EmptyAction.html">EmptyAction</a>
              </li>
              <li class="nav-group-task">
                <a href="Actions.html#/s:8SwiftDux10SendActiona">SendAction</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a href="Store.html">Store</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a href="Classes/Store.html">Store</a>
              </li>
              <li class="nav-group-task">
                <a href="Protocols/Reducer.html">Reducer</a>
              </li>
              <li class="nav-group-task">
                <a href="Structs/StoreProxy.html">StoreProxy</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/CombinedReducer.html">CombinedReducer</a>
              </li>
              <li class="nav-group-task">
                <a href="Enums/StoreAction.html">StoreAction</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a href="SwiftUI.html">SwiftUI</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a href="Extensions/View.html">View</a>
              </li>
              <li class="nav-group-task">
                <a href="Structs/MappedState.html">MappedState</a>
              </li>
              <li class="nav-group-task">
                <a href="Structs/MappedDispatch.html">MappedDispatch</a>
              </li>
              <li class="nav-group-task">
                <a href="Protocols/ConnectableView.html">ConnectableView</a>
              </li>
              <li class="nav-group-task">
                <a href="Structs/ActionBinder.html">ActionBinder</a>
              </li>
              <li class="nav-group-task">
                <a href="Structs/ActionBinding.html">ActionBinding</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a href="Middleware.html">Middleware</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a href="Protocols/Middleware.html">Middleware</a>
              </li>
              <li class="nav-group-task">
                <a href="Structs/CombinedMiddleware.html">CombinedMiddleware</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/HandleActionMiddleware.html">HandleActionMiddleware</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a href="Other%20Classes.html">Other Classes</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a href="Classes/StoreWrapperEnvironmentKey.html">StoreWrapperEnvironmentKey</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a href="Other%20Extensions.html">Other Extensions</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a href="Extensions/EnvironmentValues.html">EnvironmentValues</a>
              </li>
              <li class="nav-group-task">
                <a href="Extensions/Publisher.html">Publisher</a>
              </li>
              <li class="nav-group-task">
                <a href="Extensions/RangeReplaceableCollection.html">RangeReplaceableCollection</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a href="Other%20Protocols.html">Other Protocols</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a href="Protocols/AnyStore.html">AnyStore</a>
              </li>
              <li class="nav-group-task">
                <a href="Protocols/Connectable.html">Connectable</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a href="Other%20Structs.html">Other Structures</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a href="Structs/Connector.html">Connector</a>
              </li>
              <li class="nav-group-task">
                <a href="Structs/OnActionViewModifier.html">OnActionViewModifier</a>
              </li>
              <li class="nav-group-task">
                <a href="Structs/OnAppearDispatchActionPlanViewModifier.html">OnAppearDispatchActionPlanViewModifier</a>
              </li>
              <li class="nav-group-task">
                <a href="Structs/OnAppearDispatchActionViewModifier.html">OnAppearDispatchActionViewModifier</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a href="Other%20Typealiases.html">Other Type Aliases</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a href="Other%20Typealiases.html#/s:8SwiftDux11StateBindera">StateBinder</a>
              </li>
            </ul>
          </li>
        </ul>
      </nav>
      <article class="main-content">
        <section>
          <section class="section">
            
            <h1 id='swiftdux' class='heading'>SwiftDux</h1>

<blockquote>
<p>Predictable state management for SwiftUI applications.</p>
</blockquote>

<p><a href="https://swift.org/"><img src="https://img.shields.io/badge/swift-5.2-orange.svg" alt="Swift Version"></a>
<img src="https://img.shields.io/badge/platforms-iOS%2013%20%7C%20macOS%2010.15%20%7C%20tvOS%2013%20%7C%20watchOS%206-222.svg" alt="Platform Versions">
<a href="https://github.com/StevenLambion/SwiftDux/actions"><img src="https://github.com/StevenLambion/SwiftDux/workflows/build/badge.svg" alt="Github workflow"></a>
<a href="https://codecov.io/gh/StevenLambion/SwiftDux"><img src="https://codecov.io/gh/StevenLambion/SwiftDux/branch/master/graph/badge.svg" alt="codecov"></a></p>

<p>SwiftDux is a redux inspired state management solution built on top of Combine and SwiftUI. It presents a way to implement an elm or flux like architecture as an alternative to the MVVM-like patterns Apple has presented. It allows you to build an application around predictable state using reactive, unidirectional data flows.</p>
<h2 id='features' class='heading'>Features</h2>

<ul>
<li><strong>Redux</strong> inspired state management</li>
<li><strong>SwiftUI</strong> Integration</li>
<li><strong>Middleware</strong> support</li>
<li><strong>Combine</strong> powered <strong>Action Plans</strong> to perform asynchronous workflows</li>
<li><strong>OrderedState&lt;_&gt;</strong> to display sorted entities in List views</li>
</ul>
<h2 id='built-in-middleware' class='heading'>Built-in Middleware</h2>

<ul>
<li><code>PersistStateMiddleware</code> automatically persists and restores the application state.</li>
<li><code>PrintActionMiddleware</code> prints out each dispatched action for debugging purposes.</li>
</ul>
<h2 id='libraries' class='heading'>Libraries</h2>

<ul>
<li><a href="https://github.com/StevenLambion/SwiftDuxNavigation">SwiftDuxNavigation</a> is an experimental application routing library.</li>
</ul>
<h1 id='installation' class='heading'>Installation</h1>
<h2 id='prerequisites' class='heading'>Prerequisites</h2>

<ul>
<li>Xcode 11+</li>
<li>Swift 5.1+</li>
<li>iOS 13+, macOS 10.15+, tvOS 13+, or watchOS 6+</li>
</ul>
<h2 id='install-via-xcode' class='heading'>Install via Xcode:</h2>

<p>Search for SwiftDux in Xcode&rsquo;s Swift Package Manager integration.</p>
<h2 id='install-via-the-swift-package-manager' class='heading'>Install via the Swift Package Manager:</h2>
<pre class="highlight swift"><code><span class="kd">import</span> <span class="kt">PackageDescription</span>

<span class="k">let</span> <span class="nv">package</span> <span class="o">=</span> <span class="kt">Package</span><span class="p">(</span>
  <span class="nv">dependencies</span><span class="p">:</span> <span class="p">[</span>
    <span class="o">.</span><span class="kt">Package</span><span class="p">(</span><span class="nv">url</span><span class="p">:</span> <span class="s">"https://github.com/StevenLambion/SwiftDux.git"</span><span class="p">,</span> <span class="nv">majorVersion</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="nv">minor</span><span class="p">:</span> <span class="mi">3</span><span class="p">)</span>
  <span class="p">]</span>
<span class="p">)</span>
</code></pre>
<h1 id='demo-application' class='heading'>Demo Application</h1>

<p>Take a look at the <a href="https://github.com/StevenLambion/SwiftUI-Todo-Example">Todo Example App</a> to see how SwiftDux works.</p>
<h1 id='getting-started' class='heading'>Getting Started</h1>

<p>SwiftDux helps build SwiftUI-based applications around an <a href="https://guide.elm-lang.org/architecture/">elm-like architecture</a> using a single, centralized state container. It has 4 basic constructs:</p>

<ul>
<li><strong>State</strong> - An immutable, single source of truth within the application.</li>
<li><strong>Action</strong> - Describes a single change of the state.</li>
<li><strong>Reducer</strong> - Returns a new state by consuming the previous one with an action.</li>
<li><strong>View</strong> - The visual representation of the current state.</li>
</ul>

<div style="text-align:center">
  <img src="Guides/Images/architecture.jpg" width="400"/>
</div>
<h2 id='state' class='heading'>State</h2>

<p>The state is a single, immutable structure acting as the single source of truth within the application.</p>

<p>Below is an example of a todo app&rsquo;s state. It has a root <code>AppState</code> as well as an ordered list of <code>TodoState</code> objects.</p>
<pre class="highlight swift"><code><span class="kd">import</span> <span class="kt">SwiftDux</span>

<span class="kd">struct</span> <span class="kt">AppState</span><span class="p">:</span> <span class="kt">StateTyoe</span> <span class="p">{</span>
  <span class="nv">todos</span><span class="p">:</span> <span class="kt">OrderedState</span><span class="o">&lt;</span><span class="kt">TodoItem</span><span class="o">&gt;</span>
<span class="p">}</span>

<span class="kd">struct</span> <span class="kt">TodoItem</span><span class="p">:</span> <span class="kt">IdentifiableState</span> <span class="p">{</span>
  <span class="k">var</span> <span class="nv">id</span><span class="p">:</span> <span class="kt">String</span><span class="p">,</span>
  <span class="k">var</span> <span class="nv">text</span><span class="p">:</span> <span class="kt">String</span>
<span class="p">}</span>
</code></pre>
<h2 id='actions' class='heading'>Actions</h2>

<p>An action is a description of how the state will change. They&rsquo;re typically dispatched from events in the application. This could be a user interacting with the application or a service API receiving updates. Swift&rsquo;s enum type is ideal for actions, but structs and classes could be used as well.</p>
<pre class="highlight swift"><code><span class="kd">import</span> <span class="kt">SwiftDux</span>

<span class="kd">enum</span> <span class="kt">TodoAction</span><span class="p">:</span> <span class="kt">Action</span> <span class="p">{</span>
  <span class="k">case</span> <span class="nf">addTodo</span><span class="p">(</span><span class="nv">text</span><span class="p">:</span> <span class="kt">String</span><span class="p">)</span>
  <span class="k">case</span> <span class="nf">removeTodos</span><span class="p">(</span><span class="nv">at</span><span class="p">:</span> <span class="kt">IndexSet</span><span class="p">)</span>
  <span class="k">case</span> <span class="nf">moveTodos</span><span class="p">(</span><span class="nv">from</span><span class="p">:</span> <span class="kt">IndexSet</span><span class="p">,</span> <span class="nv">to</span><span class="p">:</span> <span class="kt">Int</span><span class="p">)</span>
<span class="p">}</span>
</code></pre>
<h2 id='reducers' class='heading'>Reducers</h2>

<p>A reducer consumes an action to produce a new state. The <code><a href="Protocols/Reducer.html">Reducer</a></code> protocol has two primary methods to override:</p>

<ul>
<li><code>reduce(state:action:)</code> - For actions supported by the reducer.</li>
<li><code>reduceNext(state:action:)</code> - Dispatches an action to any sub-reducers. This method is optional.</li>
</ul>
<pre class="highlight swift"><code><span class="kd">final</span> <span class="kd">class</span> <span class="kt">TodosReducer</span><span class="p">:</span> <span class="kt">Reducer</span> <span class="p">{</span>

  <span class="kd">func</span> <span class="nf">reduce</span><span class="p">(</span><span class="nv">state</span><span class="p">:</span> <span class="kt">OrderedState</span><span class="o">&lt;</span><span class="kt">TodoItem</span><span class="o">&gt;</span><span class="p">,</span> <span class="nv">action</span><span class="p">:</span> <span class="kt">TodoAction</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kt">OrderedState</span><span class="o">&lt;</span><span class="kt">TodoItem</span><span class="o">&gt;</span> <span class="p">{</span>
    <span class="k">var</span> <span class="nv">state</span> <span class="o">=</span> <span class="n">state</span>
    <span class="k">switch</span> <span class="n">action</span> <span class="p">{</span>
    <span class="k">case</span> <span class="o">.</span><span class="nf">addTodo</span><span class="p">(</span><span class="k">let</span> <span class="nv">text</span><span class="p">):</span>
      <span class="k">let</span> <span class="nv">id</span> <span class="o">=</span> <span class="kt">UUID</span><span class="p">()</span><span class="o">.</span><span class="n">uuidString</span>
      <span class="n">state</span><span class="o">.</span><span class="nf">append</span><span class="p">(</span><span class="kt">TodoItemState</span><span class="p">(</span><span class="nv">id</span><span class="p">:</span> <span class="n">id</span><span class="p">,</span> <span class="nv">text</span><span class="p">:</span> <span class="n">text</span><span class="p">))</span>
    <span class="k">case</span> <span class="o">.</span><span class="nf">removeTodos</span><span class="p">(</span><span class="k">let</span> <span class="nv">indexSet</span><span class="p">):</span>
      <span class="n">state</span><span class="o">.</span><span class="nf">remove</span><span class="p">(</span><span class="nv">at</span><span class="p">:</span> <span class="n">indexSet</span><span class="p">)</span>
    <span class="k">case</span> <span class="o">.</span><span class="nf">moveTodos</span><span class="p">(</span><span class="k">let</span> <span class="nv">indexSet</span><span class="p">,</span> <span class="k">let</span> <span class="nv">index</span><span class="p">):</span>
      <span class="n">state</span><span class="o">.</span><span class="nf">move</span><span class="p">(</span><span class="nv">from</span><span class="p">:</span> <span class="n">indexSet</span><span class="p">,</span> <span class="nv">to</span><span class="p">:</span> <span class="n">index</span><span class="p">)</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="n">state</span>
  <span class="p">}</span>

<span class="p">}</span>
</code></pre>

<p>Here&rsquo;s an example of a root reducer dispatching to a subreducer.</p>
<pre class="highlight swift"><code><span class="kd">final</span> <span class="kd">class</span> <span class="kt">AppReducer</span><span class="p">:</span> <span class="kt">Reducer</span> <span class="p">{</span>
  <span class="k">let</span> <span class="nv">todosReducer</span> <span class="o">=</span> <span class="kt">TodosReducer</span><span class="p">()</span>

  <span class="kd">func</span> <span class="nf">reduceNext</span><span class="p">(</span><span class="nv">state</span><span class="p">:</span> <span class="kt">AppState</span><span class="p">,</span> <span class="nv">action</span><span class="p">:</span> <span class="kt">TodoAction</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kt">AppState</span> <span class="p">{</span>
    <span class="kt">State</span><span class="p">(</span>
      <span class="nv">todos</span><span class="p">:</span> <span class="n">todosReducer</span><span class="o">.</span><span class="nf">reduceAny</span><span class="p">(</span><span class="n">state</span><span class="o">.</span><span class="n">todos</span><span class="p">,</span> <span class="n">action</span><span class="p">)</span>
    <span class="p">)</span>
  <span class="p">}</span>

<span class="p">}</span>
</code></pre>

<p>Reducers can also be combined together. This is useful when multiple root reducers are needed, such as two reducers from separate modules.</p>
<pre class="highlight swift"><code><span class="k">let</span> <span class="nv">combinedReducer</span> <span class="o">=</span> <span class="kt">AppReducer</span> <span class="o">+</span> <span class="kt">NavigationReducer</span>
</code></pre>
<h2 id='store' class='heading'>Store</h2>

<p>The store acts as the container of the state. It needs to be initialized with a default state and a root reducer. Then inject it into the application using the <code>provideStore(_:)</code> view modifier.</p>
<pre class="highlight swift"><code><span class="kd">import</span> <span class="kt">SwiftDux</span>

<span class="k">let</span> <span class="nv">store</span> <span class="o">=</span> <span class="kt">Store</span><span class="p">(</span><span class="kt">AppState</span><span class="p">(</span><span class="nv">todos</span><span class="p">:</span> <span class="kt">OrderedState</span><span class="p">()),</span> <span class="kt">AppReducer</span><span class="p">())</span>

<span class="n">window</span><span class="o">.</span><span class="n">rootViewController</span> <span class="o">=</span> <span class="kt">UIHostingController</span><span class="p">(</span>
  <span class="nv">rootView</span><span class="p">:</span> <span class="kt">RootView</span><span class="p">()</span><span class="o">.</span><span class="nf">provideStore</span><span class="p">(</span><span class="n">store</span><span class="p">)</span>
<span class="p">)</span>
</code></pre>
<h2 id='connectable-view' class='heading'>Connectable View</h2>

<p>The <code><a href="Protocols/ConnectableView.html">ConnectableView</a></code> protocol provides a slice of the application state to your views using the functions <code>map(state:)</code> and <code>body(props:)</code>. The <code>@MappedDispatch</code> property wrapper injects an <code><a href="Protocols/ActionDispatcher.html">ActionDispatcher</a></code> to send actions to the store.</p>
<pre class="highlight swift"><code><span class="kd">struct</span> <span class="kt">TodosView</span><span class="p">:</span> <span class="kt">ConnectableView</span> <span class="p">{</span>
  <span class="kd">@MappedDispatch</span><span class="p">()</span> <span class="kd">private</span> <span class="k">var</span> <span class="nv">dispatch</span>

  <span class="kd">func</span> <span class="nf">map</span><span class="p">(</span><span class="nv">state</span><span class="p">:</span> <span class="kt">AppState</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kt">OrderedState</span><span class="o">&lt;</span><span class="kt">Todo</span><span class="o">&gt;</span><span class="p">?</span> <span class="p">{</span>
    <span class="n">state</span><span class="o">.</span><span class="n">todos</span>
  <span class="p">}</span>

  <span class="kd">func</span> <span class="nf">body</span><span class="p">(</span><span class="nv">props</span><span class="p">:</span> <span class="kt">OrderedState</span><span class="o">&lt;</span><span class="kt">Todo</span><span class="o">&gt;</span><span class="p">):</span> <span class="n">some</span> <span class="kt">View</span> <span class="p">{</span>
    <span class="kt">List</span> <span class="p">{</span>
      <span class="kt">ForEach</span><span class="p">(</span><span class="n">todos</span><span class="p">)</span> <span class="p">{</span> <span class="n">todo</span> <span class="k">in</span>
        <span class="kt">TodoItemRow</span><span class="p">(</span><span class="nv">item</span><span class="p">:</span> <span class="n">todo</span><span class="p">)</span>
      <span class="p">}</span>
      <span class="o">.</span><span class="n">onDelete</span> <span class="p">{</span> <span class="k">self</span><span class="o">.</span><span class="nf">dispatch</span><span class="p">(</span><span class="kt">TodoAction</span><span class="o">.</span><span class="nf">removeTodos</span><span class="p">(</span><span class="nv">at</span><span class="p">:</span> <span class="nv">$0</span><span class="p">))</span> <span class="p">}</span>
      <span class="o">.</span><span class="n">onMove</span> <span class="p">{</span> <span class="k">self</span><span class="o">.</span><span class="nf">dispatch</span><span class="p">(</span><span class="kt">TodoAction</span><span class="o">.</span><span class="nf">moveTodos</span><span class="p">(</span><span class="nv">from</span><span class="p">:</span> <span class="nv">$0</span><span class="p">,</span> <span class="nv">to</span><span class="p">:</span> <span class="nv">$1</span><span class="p">))</span> <span class="p">}</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre>

<p>The view can later be placed like any other.</p>
<pre class="highlight swift"><code><span class="kd">struct</span> <span class="kt">RootView</span><span class="p">:</span> <span class="kt">View</span> <span class="p">{</span>

  <span class="k">var</span> <span class="nv">body</span><span class="p">:</span> <span class="n">some</span> <span class="kt">View</span> <span class="p">{</span>
    <span class="kt">TodosView</span><span class="p">()</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre>
<h2 id='passing-data-to-a-connectable-view' class='heading'>Passing Data to a Connectable View</h2>

<p>In some cases, a connected view needs external information to map the state to its props, such as an identifier. Simply add any needed variables to your view, and access them in the mapping function.</p>
<pre class="highlight swift"><code><span class="kd">struct</span> <span class="kt">TodoDetailsView</span><span class="p">:</span> <span class="kt">ConnectableView</span> <span class="p">{</span>
  <span class="k">var</span> <span class="nv">id</span><span class="p">:</span> <span class="kt">String</span>

  <span class="kd">func</span> <span class="nf">map</span><span class="p">(</span><span class="nv">state</span><span class="p">:</span> <span class="kt">TodoList</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kt">Todo</span><span class="p">?</span> <span class="p">{</span>
    <span class="n">state</span><span class="p">[</span><span class="n">id</span><span class="p">]</span>
  <span class="p">}</span>
<span class="p">}</span>

<span class="c1">// Somewhere else in the view hierarchy:</span>

<span class="kt">TodoDetailsView</span><span class="p">(</span><span class="nv">id</span><span class="p">:</span> <span class="s">"123"</span><span class="p">)</span>
</code></pre>
<h2 id='actionbinding-lt-_-gt' class='heading'>ActionBinding&lt;_&gt;</h2>

<p>SwiftUI has a focus on two-way bindings that connect to a single value source. To support updates through actions, SwiftDux provides a convenient API in the <code><a href="Protocols/ConnectableView.html">ConnectableView</a></code> protocol using an <code><a href="Structs/ActionBinder.html">ActionBinder</a></code> object. Use the <code>map(state:binder:)</code> method on the protocol as shown below. It provides a value to the text field, and dispatches an action when the text value changes. It also binds a function to a dispatchable action.</p>
<pre class="highlight swift"><code><span class="kd">struct</span> <span class="kt">LoginForm</span><span class="p">:</span> <span class="kt">View</span> <span class="p">{</span>

  <span class="kd">struct</span> <span class="kt">Props</span><span class="p">:</span> <span class="kt">Equatable</span> <span class="p">{</span>
    <span class="kd">@ActionBinding</span> <span class="k">var</span> <span class="nv">email</span><span class="p">:</span> <span class="kt">String</span>
    <span class="kd">@ActionBinding</span> <span class="k">var</span> <span class="nv">onSubmit</span><span class="p">:</span> <span class="p">()</span><span class="o">-&gt;</span><span class="p">()</span>
  <span class="p">}</span>

  <span class="kd">func</span> <span class="nf">map</span><span class="p">(</span><span class="nv">state</span><span class="p">:</span> <span class="kt">AppState</span><span class="p">,</span> <span class="nv">binder</span><span class="p">:</span> <span class="kt">ActionBinder</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kt">Props</span><span class="p">?</span> <span class="p">{</span>
    <span class="kt">Props</span><span class="p">(</span>
      <span class="nv">email</span><span class="p">:</span> <span class="n">binder</span><span class="o">.</span><span class="nf">bind</span><span class="p">(</span><span class="n">state</span><span class="o">.</span><span class="n">loginForm</span><span class="o">.</span><span class="n">email</span><span class="p">)</span> <span class="p">{</span> 
        <span class="kt">LoginFormAction</span><span class="o">.</span><span class="nf">setEmail</span><span class="p">(</span><span class="nv">$0</span><span class="p">)</span>
      <span class="p">},</span>
      <span class="nv">onSubmit</span><span class="p">:</span> <span class="n">binder</span><span class="o">.</span><span class="nf">bind</span><span class="p">(</span><span class="kt">LoginFormAction</span><span class="o">.</span><span class="n">submit</span><span class="p">)</span>
    <span class="p">)</span>
  <span class="p">}</span>

  <span class="kd">func</span> <span class="nf">body</span><span class="p">(</span><span class="nv">props</span><span class="p">:</span> <span class="kt">Props</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">some</span> <span class="kt">View</span> <span class="p">{</span>
    <span class="kt">VStack</span> <span class="p">{</span>
      <span class="kt">TextField</span><span class="p">(</span><span class="s">"Email"</span><span class="p">,</span> <span class="nv">text</span><span class="p">:</span> <span class="err">$</span><span class="n">props</span><span class="o">.</span><span class="n">email</span><span class="p">)</span>
      <span class="cm">/* ... */</span>
      <span class="kt">Button</span><span class="p">(</span><span class="nv">action</span><span class="p">:</span> <span class="n">props</span><span class="o">.</span><span class="n">onSubmit</span><span class="p">)</span> <span class="p">{</span>
        <span class="kt">Text</span><span class="p">(</span><span class="s">"Submit"</span><span class="p">)</span>
      <span class="p">}</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre>
<h2 id='previewing-connected-views' class='heading'>Previewing Connected Views</h2>

<p>To preview a connected view by itself, you can provide a store that contains the parent state and reducer it maps from. This preview is based on a view in the Todo List Example project. Make sure to add <code>provideStore(_:)</code> after the connect method.</p>
<pre class="highlight swift"><code><span class="cp">#if DEBUG</span>
<span class="kd">public</span> <span class="kd">enum</span> <span class="kt">TodoRowContainer_Previews</span><span class="p">:</span> <span class="kt">PreviewProvider</span> <span class="p">{</span>
  <span class="kd">static</span> <span class="k">var</span> <span class="nv">store</span><span class="p">:</span> <span class="kt">Store</span><span class="o">&lt;</span><span class="kt">TodoList</span><span class="o">&gt;</span> <span class="p">{</span>
    <span class="kt">Store</span><span class="p">(</span>
      <span class="nv">state</span><span class="p">:</span> <span class="kt">TodoList</span><span class="p">(</span>
        <span class="nv">id</span><span class="p">:</span> <span class="s">"1"</span><span class="p">,</span>
        <span class="nv">name</span><span class="p">:</span> <span class="s">"TodoList"</span><span class="p">,</span>
        <span class="nv">todos</span><span class="p">:</span> <span class="o">.</span><span class="nf">init</span><span class="p">([</span>
          <span class="kt">Todo</span><span class="p">(</span><span class="nv">id</span><span class="p">:</span> <span class="s">"1"</span><span class="p">,</span> <span class="nv">text</span><span class="p">:</span> <span class="s">"Get milk"</span><span class="p">)</span>
        <span class="p">])</span>
      <span class="p">),</span>
      <span class="nv">reducer</span><span class="p">:</span> <span class="kt">TodosReducer</span><span class="p">()</span>
    <span class="p">)</span>
  <span class="p">}</span>

  <span class="kd">public</span> <span class="kd">static</span> <span class="k">var</span> <span class="nv">previews</span><span class="p">:</span> <span class="n">some</span> <span class="kt">View</span> <span class="p">{</span>
    <span class="kt">TodoRowContainer</span><span class="p">(</span><span class="nv">id</span><span class="p">:</span> <span class="s">"1"</span><span class="p">)</span>
      <span class="o">.</span><span class="nf">provideStore</span><span class="p">(</span><span class="n">store</span><span class="p">)</span>
  <span class="p">}</span>

<span class="p">}</span>
<span class="cp">#endif</span>
</code></pre>
<h2 id='action-plans' class='heading'>Action Plans</h2>

<p>An <code><a href="Structs/ActionPlan.html">ActionPlan</a></code> is a special kind of action that can be used to group other actions together or perform any kind of async logic.</p>
<pre class="highlight swift"><code><span class="c1">/// Dispatch multiple actions together synchronously:</span>

<span class="k">let</span> <span class="nv">plan</span> <span class="o">=</span> <span class="kt">ActionPlan</span><span class="o">&lt;</span><span class="kt">AppState</span><span class="o">&gt;</span> <span class="p">{</span> <span class="n">store</span> <span class="k">in</span>
  <span class="n">store</span><span class="o">.</span><span class="nf">send</span><span class="p">(</span><span class="n">actionA</span><span class="p">)</span>
  <span class="n">store</span><span class="o">.</span><span class="nf">send</span><span class="p">(</span><span class="n">actionB</span><span class="p">)</span>
  <span class="n">store</span><span class="o">.</span><span class="nf">send</span><span class="p">(</span><span class="n">actionB</span><span class="p">)</span>
<span class="p">}</span>

<span class="c1">/// Perform async operations:</span>

<span class="k">let</span> <span class="nv">plan</span> <span class="o">=</span> <span class="kt">ActionPlan</span><span class="o">&lt;</span><span class="kt">AppState</span><span class="o">&gt;</span> <span class="p">{</span> <span class="n">store</span> <span class="k">in</span>
  <span class="n">userLocationService</span><span class="o">.</span><span class="n">getLocation</span> <span class="p">{</span> <span class="n">location</span>
    <span class="n">store</span><span class="o">.</span><span class="nf">send</span><span class="p">(</span><span class="kt">LocationAction</span><span class="o">.</span><span class="nf">updateLocation</span><span class="p">(</span><span class="n">location</span><span class="p">))</span>
  <span class="p">}</span>
<span class="p">}</span>

<span class="c1">/// Subscribe to services and publish new actions to the store.</span>

<span class="k">let</span> <span class="nv">plan</span> <span class="o">=</span> <span class="kt">ActionPlan</span><span class="o">&lt;</span><span class="kt">AppState</span><span class="o">&gt;</span> <span class="p">{</span> <span class="n">store</span><span class="p">,</span> <span class="n">completed</span> <span class="k">in</span>
  <span class="n">userLocationService</span>
    <span class="o">.</span><span class="nf">subscribeToUpdates</span><span class="p">()</span>
    <span class="o">.</span><span class="n">map</span> <span class="p">{</span> <span class="kt">LocationAction</span><span class="o">.</span><span class="nf">updateLocation</span><span class="p">(</span><span class="nv">$0</span><span class="p">)</span> <span class="p">}</span>
    <span class="o">.</span><span class="nf">send</span><span class="p">(</span><span class="nv">to</span><span class="p">:</span> <span class="n">store</span><span class="p">,</span> <span class="nv">receivedCompletion</span><span class="p">:</span> <span class="n">completed</span><span class="p">)</span>
<span class="p">}</span>

<span class="c1">/// In a View, dispatch the plan like any other action:</span>

<span class="nf">dispatch</span><span class="p">(</span><span class="n">plan</span><span class="p">)</span>
</code></pre>
<h2 id='query-external-services' class='heading'>Query External Services</h2>

<p>Action plans can be used in conjunction with the <code>onAppear(dispatch:)</code> view modifier to connect to external data sources when a view appears. If the action plan returns a publisher, it will automatically cancel when the view disappears. Optionally, use <code>onAppear(dispatch:cancelOnDisappear:)</code> if the publisher should continue.</p>

<p>Action plans can also subscribe to the store. This is useful when the query needs to be refreshed if the application state changes. Rather than imperatively handling this by re-sending the action plan, it can be done more declaratively within it.</p>

<p>Here&rsquo;s an example of an action plan that queries for todos. It updates whenever the filter changes. It also debounces to reduce the amount of queries sent to the external services.</p>
<pre class="highlight swift"><code><span class="kd">enum</span> <span class="kt">TodoListAction</span> <span class="p">{</span>
  <span class="o">...</span>
<span class="p">}</span>

<span class="kd">extension</span> <span class="kt">TodoListAction</span> <span class="p">{</span>

  <span class="kd">static</span> <span class="kd">func</span> <span class="nf">getState</span><span class="p">(</span><span class="n">from</span> <span class="nv">store</span><span class="p">:</span> <span class="kt">Store</span><span class="o">&lt;</span><span class="kt">AppState</span><span class="o">&gt;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">some</span> <span class="kt">Publisher</span> <span class="p">{</span>
    <span class="kt">Just</span><span class="p">(</span><span class="n">store</span><span class="o">.</span><span class="n">state</span><span class="p">)</span><span class="o">.</span><span class="nf">merge</span><span class="p">(</span><span class="nv">with</span><span class="p">:</span> <span class="n">store</span><span class="o">.</span><span class="n">didChange</span><span class="o">.</span><span class="n">map</span> <span class="p">{</span> <span class="n">_</span> <span class="k">in</span> <span class="n">store</span><span class="o">.</span><span class="n">state</span> <span class="p">})</span>
  <span class="p">}</span>

  <span class="kd">static</span> <span class="kd">func</span> <span class="nf">queryTodos</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="kt">ActionPlan</span><span class="o">&lt;</span><span class="kt">AppState</span><span class="o">&gt;</span> <span class="p">{</span>
    <span class="kt">ActionPlan</span><span class="o">&lt;</span><span class="kt">AppState</span><span class="o">&gt;</span> <span class="p">{</span> <span class="n">store</span><span class="p">,</span> <span class="n">completed</span> <span class="k">in</span>
      <span class="nf">getState</span><span class="p">(</span><span class="nv">from</span><span class="p">:</span> <span class="n">store</span><span class="p">)</span>
        <span class="o">.</span><span class="n">map</span> <span class="p">{</span> <span class="nv">$0</span><span class="o">.</span><span class="n">filterBy</span> <span class="p">}</span>
        <span class="o">.</span><span class="nf">removeDuplicates</span><span class="p">()</span>
        <span class="o">.</span><span class="nf">debounce</span><span class="p">(</span><span class="nv">for</span><span class="p">:</span> <span class="o">.</span><span class="nf">milliseconds</span><span class="p">(</span><span class="mi">300</span><span class="p">),</span> <span class="nv">scheduler</span><span class="p">:</span> <span class="kt">RunLoop</span><span class="o">.</span><span class="n">main</span><span class="p">)</span>
        <span class="o">.</span><span class="n">flatMap</span> <span class="p">{</span> <span class="n">filter</span> <span class="k">in</span> <span class="k">self</span><span class="o">.</span><span class="n">services</span><span class="o">.</span><span class="nf">queryTodos</span><span class="p">(</span><span class="nv">filter</span><span class="p">:</span> <span class="n">filter</span><span class="p">)</span> <span class="p">}</span>
        <span class="o">.</span><span class="k">catch</span> <span class="p">{</span> <span class="n">_</span> <span class="k">in</span> <span class="kt">Just</span><span class="o">&lt;</span><span class="p">[</span><span class="kt">TodoItem</span><span class="p">]</span><span class="o">&gt;</span><span class="p">([])</span> <span class="p">}</span>
        <span class="o">.</span><span class="n">map</span> <span class="p">{</span> <span class="n">todos</span> <span class="o">-&gt;</span> <span class="kt">Action</span> <span class="k">in</span> <span class="kt">TodoListAction</span><span class="o">.</span><span class="nf">setTodos</span><span class="p">(</span><span class="n">todos</span><span class="p">)</span> <span class="p">}</span>
        <span class="o">.</span><span class="nf">send</span><span class="p">(</span><span class="nv">to</span><span class="p">:</span> <span class="n">store</span><span class="p">,</span> <span class="nv">receivedCompletion</span><span class="p">:</span> <span class="n">completed</span><span class="p">)</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>

<span class="kd">struct</span> <span class="kt">TodoListView</span><span class="p">:</span> <span class="kt">ConnectableView</span> <span class="p">{</span>

  <span class="kd">func</span> <span class="nf">map</span><span class="p">(</span><span class="nv">state</span><span class="p">:</span> <span class="kt">AppState</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="p">[</span><span class="kt">TodoItem</span><span class="p">]?</span> <span class="p">{</span>
    <span class="n">state</span><span class="o">.</span><span class="n">todoList</span><span class="o">.</span><span class="n">items</span>
  <span class="p">}</span>

  <span class="kd">func</span> <span class="nf">body</span><span class="p">(</span><span class="nv">props</span><span class="p">:</span> <span class="p">[</span><span class="kt">TodoItem</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">some</span> <span class="kt">View</span> <span class="p">{</span>
    <span class="nf">renderTodos</span><span class="p">(</span><span class="nv">todos</span><span class="p">:</span> <span class="n">props</span><span class="p">)</span>
      <span class="o">.</span><span class="nf">onAppear</span><span class="p">(</span><span class="nv">dispatch</span><span class="p">:</span> <span class="kt">TodoListAction</span><span class="o">.</span><span class="nf">queryTodos</span><span class="p">())</span>
  <span class="p">}</span>

  <span class="c1">// ...</span>
<span class="p">}</span>
</code></pre>

          </section>
        </section>
        <section id="footer">
          <p>&copy; 2020 <a class="link" href="" target="_blank" rel="external"></a>. All rights reserved. (Last updated: 2020-10-14)</p>
          <p>Generated by <a class="link" href="https://github.com/realm/jazzy" target="_blank" rel="external">jazzy ♪♫ v0.13.1</a>, a <a class="link" href="https://realm.io" target="_blank" rel="external">Realm</a> project.</p>
        </section>
      </article>
    </div>
  </body>
</div>
</html>
